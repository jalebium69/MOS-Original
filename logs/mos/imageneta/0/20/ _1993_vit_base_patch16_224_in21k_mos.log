2024-01-28 01:21:53,422 [trainer.py] => config: ./exps/mos_ina_in21k.json
2024-01-28 01:21:53,422 [trainer.py] => prefix:  
2024-01-28 01:21:53,422 [trainer.py] => dataset: imageneta
2024-01-28 01:21:53,422 [trainer.py] => memory_size: 0
2024-01-28 01:21:53,422 [trainer.py] => memory_per_class: 0
2024-01-28 01:21:53,422 [trainer.py] => fixed_memory: False
2024-01-28 01:21:53,422 [trainer.py] => shuffle: True
2024-01-28 01:21:53,422 [trainer.py] => init_cls: 20
2024-01-28 01:21:53,422 [trainer.py] => increment: 20
2024-01-28 01:21:53,422 [trainer.py] => model_name: mos
2024-01-28 01:21:53,422 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_mos
2024-01-28 01:21:53,422 [trainer.py] => device: [device(type='cuda', index=2)]
2024-01-28 01:21:53,422 [trainer.py] => seed: 1993
2024-01-28 01:21:53,422 [trainer.py] => tuned_epoch: 10
2024-01-28 01:21:53,422 [trainer.py] => init_lr: 0.05
2024-01-28 01:21:53,423 [trainer.py] => batch_size: 32
2024-01-28 01:21:53,423 [trainer.py] => weight_decay: 0.005
2024-01-28 01:21:53,423 [trainer.py] => min_lr: 0
2024-01-28 01:21:53,423 [trainer.py] => optimizer: sgd
2024-01-28 01:21:53,423 [trainer.py] => scheduler: cosine
2024-01-28 01:21:53,423 [trainer.py] => reinit_optimizer: True
2024-01-28 01:21:53,423 [trainer.py] => init_milestones: [10]
2024-01-28 01:21:53,423 [trainer.py] => init_lr_decay: 0.1
2024-01-28 01:21:53,423 [trainer.py] => reg: 0.1
2024-01-28 01:21:53,423 [trainer.py] => adapter_momentum: 0.1
2024-01-28 01:21:53,423 [trainer.py] => ensemble: True
2024-01-28 01:21:53,423 [trainer.py] => crct_epochs: 30
2024-01-28 01:21:53,423 [trainer.py] => ca_lr: 0.005
2024-01-28 01:21:53,423 [trainer.py] => ca_storage_efficient_method: variance
2024-01-28 01:21:53,423 [trainer.py] => ca_storage_efficient_method_choices: ['covariance', 'multi-centroid', 'variance']
2024-01-28 01:21:53,423 [trainer.py] => n_centroids: 10
2024-01-28 01:21:53,423 [trainer.py] => pretrained: True
2024-01-28 01:21:53,423 [trainer.py] => drop: 0.0
2024-01-28 01:21:53,423 [trainer.py] => drop_path: 0.0
2024-01-28 01:21:53,423 [trainer.py] => ffn_num: 16
2024-01-28 01:21:53,479 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-01-28 01:21:57,660 [mos.py] => 86,256,776 model total parameters.
2024-01-28 01:21:57,661 [mos.py] => 458,120 model training parameters.
2024-01-28 01:21:57,661 [mos.py] => head.weight: 153600
2024-01-28 01:21:57,661 [mos.py] => head.bias: 200
2024-01-28 01:21:57,661 [mos.py] => cur_adapter.0.down_proj.weight: 12288
2024-01-28 01:21:57,661 [mos.py] => cur_adapter.0.down_proj.bias: 16
2024-01-28 01:21:57,661 [mos.py] => cur_adapter.0.up_proj.weight: 12288
2024-01-28 01:21:57,661 [mos.py] => cur_adapter.0.up_proj.bias: 768
2024-01-28 01:21:57,661 [mos.py] => cur_adapter.1.down_proj.weight: 12288
2024-01-28 01:21:57,661 [mos.py] => cur_adapter.1.down_proj.bias: 16
2024-01-28 01:21:57,661 [mos.py] => cur_adapter.1.up_proj.weight: 12288
2024-01-28 01:21:57,661 [mos.py] => cur_adapter.1.up_proj.bias: 768
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.2.down_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.2.down_proj.bias: 16
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.2.up_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.2.up_proj.bias: 768
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.3.down_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.3.down_proj.bias: 16
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.3.up_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.3.up_proj.bias: 768
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.4.down_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.4.down_proj.bias: 16
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.4.up_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.4.up_proj.bias: 768
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.5.down_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.5.down_proj.bias: 16
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.5.up_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.5.up_proj.bias: 768
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.6.down_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.6.down_proj.bias: 16
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.6.up_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.6.up_proj.bias: 768
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.7.down_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.7.down_proj.bias: 16
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.7.up_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.7.up_proj.bias: 768
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.8.down_proj.weight: 12288
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.8.down_proj.bias: 16
2024-01-28 01:21:57,662 [mos.py] => cur_adapter.8.up_proj.weight: 12288
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.8.up_proj.bias: 768
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.9.down_proj.weight: 12288
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.9.down_proj.bias: 16
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.9.up_proj.weight: 12288
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.9.up_proj.bias: 768
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.10.down_proj.weight: 12288
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.10.down_proj.bias: 16
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.10.up_proj.weight: 12288
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.10.up_proj.bias: 768
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.11.down_proj.weight: 12288
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.11.down_proj.bias: 16
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.11.up_proj.weight: 12288
2024-01-28 01:21:57,663 [mos.py] => cur_adapter.11.up_proj.bias: 768
2024-01-28 01:21:57,664 [trainer.py] => All params: 86256776
2024-01-28 01:21:57,664 [trainer.py] => Trainable params: 458120
2024-01-28 01:21:57,665 [mos.py] => Learning on 0-20
2024-01-28 01:22:25,175 [mos.py] => Task 0, Epoch 10/10 => Loss 0.200, Train_accy 94.47
2024-01-28 01:22:39,773 [mos.py] => the accuracy of the original model:81.71
2024-01-28 01:22:39,774 [trainer.py] => No NME accuracy.
2024-01-28 01:22:39,774 [trainer.py] => CNN: {'total': 80.57, '00-19': 80.57, 'old': 0, 'new': 80.57}
2024-01-28 01:22:39,774 [trainer.py] => CNN top1 curve: [80.57]
2024-01-28 01:22:39,774 [trainer.py] => CNN top5 curve: [95.43]

2024-01-28 01:22:39,774 [trainer.py] => Average Accuracy (CNN): 80.57 

2024-01-28 01:22:39,775 [trainer.py] => All params: 86576457
2024-01-28 01:22:39,776 [trainer.py] => Trainable params: 762440
2024-01-28 01:22:39,777 [mos.py] => Learning on 20-40
2024-01-28 01:23:08,963 [mos.py] => Task 1, Epoch 10/10 => Loss 0.232, Train_accy 95.17
2024-01-28 01:23:25,414 [mos.py] => Task 1, Epoch 30/30 => Loss 0.011, CA_accy 99.91
2024-01-28 01:23:29,591 [mos.py] => the accuracy of the original model:77.78
2024-01-28 01:23:29,592 [trainer.py] => No NME accuracy.
2024-01-28 01:23:29,593 [trainer.py] => CNN: {'total': 77.78, '00-19': 74.29, '20-39': 81.08, 'old': 74.29, 'new': 81.08}
2024-01-28 01:23:29,593 [trainer.py] => CNN top1 curve: [80.57, 77.78]
2024-01-28 01:23:29,593 [trainer.py] => CNN top5 curve: [95.43, 94.17]

2024-01-28 01:23:29,593 [trainer.py] => Average Accuracy (CNN): 79.175 

2024-01-28 01:23:29,595 [trainer.py] => All params: 86896137
2024-01-28 01:23:29,596 [trainer.py] => Trainable params: 1066760
2024-01-28 01:23:29,597 [mos.py] => Learning on 40-60
2024-01-28 01:23:52,065 [mos.py] => Task 2, Epoch 10/10 => Loss 0.258, Train_accy 96.67
2024-01-28 01:24:07,723 [mos.py] => Task 2, Epoch 30/30 => Loss 0.012, CA_accy 99.99
2024-01-28 01:24:12,939 [mos.py] => the accuracy of the original model:72.48
2024-01-28 01:24:12,940 [trainer.py] => No NME accuracy.
2024-01-28 01:24:12,941 [trainer.py] => CNN: {'total': 73.74, '00-19': 73.71, '20-39': 74.59, '40-59': 72.41, 'old': 74.17, 'new': 72.41}
2024-01-28 01:24:12,941 [trainer.py] => CNN top1 curve: [80.57, 77.78, 73.74]
2024-01-28 01:24:12,941 [trainer.py] => CNN top5 curve: [95.43, 94.17, 92.23]

2024-01-28 01:24:12,941 [trainer.py] => Average Accuracy (CNN): 77.36333333333333 

2024-01-28 01:24:12,942 [trainer.py] => All params: 87215817
2024-01-28 01:24:12,943 [trainer.py] => Trainable params: 1371080
2024-01-28 01:24:12,944 [mos.py] => Learning on 60-80
2024-01-28 01:24:43,463 [mos.py] => Task 3, Epoch 10/10 => Loss 0.298, Train_accy 96.05
2024-01-28 01:25:03,344 [mos.py] => Task 3, Epoch 30/30 => Loss 0.017, CA_accy 99.98
2024-01-28 01:25:10,604 [mos.py] => the accuracy of the original model:69.77
2024-01-28 01:25:10,605 [trainer.py] => No NME accuracy.
2024-01-28 01:25:10,605 [trainer.py] => CNN: {'total': 70.77, '00-19': 66.86, '20-39': 73.51, '40-59': 69.83, '60-79': 72.07, 'old': 70.17, 'new': 72.07}
2024-01-28 01:25:10,605 [trainer.py] => CNN top1 curve: [80.57, 77.78, 73.74, 70.77]
2024-01-28 01:25:10,605 [trainer.py] => CNN top5 curve: [95.43, 94.17, 92.23, 90.97]

2024-01-28 01:25:10,605 [trainer.py] => Average Accuracy (CNN): 75.71499999999999 

2024-01-28 01:25:10,607 [trainer.py] => All params: 87535497
2024-01-28 01:25:10,608 [trainer.py] => Trainable params: 1675400
2024-01-28 01:25:10,610 [mos.py] => Learning on 80-100
2024-01-28 01:25:33,120 [mos.py] => Task 4, Epoch 10/10 => Loss 0.241, Train_accy 96.18
2024-01-28 01:25:52,116 [mos.py] => Task 4, Epoch 30/30 => Loss 0.020, CA_accy 100.00
2024-01-28 01:26:01,145 [mos.py] => the accuracy of the original model:65.99
2024-01-28 01:26:01,148 [trainer.py] => No NME accuracy.
2024-01-28 01:26:01,148 [trainer.py] => CNN: {'total': 67.42, '00-19': 62.86, '20-39': 71.35, '40-59': 71.55, '60-79': 70.27, '80-99': 60.14, 'old': 68.91, 'new': 60.14}
2024-01-28 01:26:01,148 [trainer.py] => CNN top1 curve: [80.57, 77.78, 73.74, 70.77, 67.42]
2024-01-28 01:26:01,148 [trainer.py] => CNN top5 curve: [95.43, 94.17, 92.23, 90.97, 88.47]

2024-01-28 01:26:01,148 [trainer.py] => Average Accuracy (CNN): 74.056 

2024-01-28 01:26:01,150 [trainer.py] => All params: 87855177
2024-01-28 01:26:01,151 [trainer.py] => Trainable params: 1979720
2024-01-28 01:26:01,153 [mos.py] => Learning on 100-120
2024-01-28 01:26:23,780 [mos.py] => Task 5, Epoch 10/10 => Loss 0.267, Train_accy 95.22
2024-01-28 01:26:43,870 [mos.py] => Task 5, Epoch 30/30 => Loss 0.023, CA_accy 99.99
2024-01-28 01:26:55,093 [mos.py] => the accuracy of the original model:63.9
2024-01-28 01:26:55,094 [trainer.py] => No NME accuracy.
2024-01-28 01:26:55,094 [trainer.py] => CNN: {'total': 65.13, '00-19': 64.0, '20-39': 67.03, '40-59': 68.1, '60-79': 68.02, '80-99': 55.94, '100-119': 66.42, 'old': 64.92, 'new': 66.42}
2024-01-28 01:26:55,094 [trainer.py] => CNN top1 curve: [80.57, 77.78, 73.74, 70.77, 67.42, 65.13]
2024-01-28 01:26:55,094 [trainer.py] => CNN top5 curve: [95.43, 94.17, 92.23, 90.97, 88.47, 87.69]

2024-01-28 01:26:55,095 [trainer.py] => Average Accuracy (CNN): 72.56833333333333 

2024-01-28 01:26:55,096 [trainer.py] => All params: 88174857
2024-01-28 01:26:55,097 [trainer.py] => Trainable params: 2284040
2024-01-28 01:26:55,098 [mos.py] => Learning on 120-140
2024-01-28 01:27:17,656 [mos.py] => Task 6, Epoch 10/10 => Loss 0.248, Train_accy 94.99
2024-01-28 01:27:39,844 [mos.py] => Task 6, Epoch 30/30 => Loss 0.028, CA_accy 100.00
2024-01-28 01:27:54,014 [mos.py] => the accuracy of the original model:61.37
2024-01-28 01:27:54,017 [trainer.py] => No NME accuracy.
2024-01-28 01:27:54,017 [trainer.py] => CNN: {'total': 62.44, '00-19': 60.57, '20-39': 65.95, '40-59': 65.52, '60-79': 64.86, '80-99': 54.55, '100-119': 66.42, '120-139': 58.22, 'old': 63.08, 'new': 58.22}
2024-01-28 01:27:54,017 [trainer.py] => CNN top1 curve: [80.57, 77.78, 73.74, 70.77, 67.42, 65.13, 62.44]
2024-01-28 01:27:54,017 [trainer.py] => CNN top5 curve: [95.43, 94.17, 92.23, 90.97, 88.47, 87.69, 85.91]

2024-01-28 01:27:54,017 [trainer.py] => Average Accuracy (CNN): 71.12142857142857 

2024-01-28 01:27:54,019 [trainer.py] => All params: 88494537
2024-01-28 01:27:54,021 [trainer.py] => Trainable params: 2588360
2024-01-28 01:27:54,023 [mos.py] => Learning on 140-160
2024-01-28 01:28:16,321 [mos.py] => Task 7, Epoch 10/10 => Loss 0.219, Train_accy 97.55
2024-01-28 01:28:38,975 [mos.py] => Task 7, Epoch 30/30 => Loss 0.032, CA_accy 100.00
2024-01-28 01:28:56,125 [mos.py] => the accuracy of the original model:58.65
2024-01-28 01:28:56,127 [trainer.py] => No NME accuracy.
2024-01-28 01:28:56,127 [trainer.py] => CNN: {'total': 59.86, '00-19': 57.71, '20-39': 62.7, '40-59': 63.79, '60-79': 63.96, '80-99': 55.24, '100-119': 64.93, '120-139': 59.59, '140-159': 48.03, 'old': 61.2, 'new': 48.03}
2024-01-28 01:28:56,127 [trainer.py] => CNN top1 curve: [80.57, 77.78, 73.74, 70.77, 67.42, 65.13, 62.44, 59.86]
2024-01-28 01:28:56,127 [trainer.py] => CNN top5 curve: [95.43, 94.17, 92.23, 90.97, 88.47, 87.69, 85.91, 83.57]

2024-01-28 01:28:56,127 [trainer.py] => Average Accuracy (CNN): 69.71374999999999 

2024-01-28 01:28:56,129 [trainer.py] => All params: 88814217
2024-01-28 01:28:56,130 [trainer.py] => Trainable params: 2892680
2024-01-28 01:28:56,132 [mos.py] => Learning on 160-180
2024-01-28 01:29:19,238 [mos.py] => Task 8, Epoch 10/10 => Loss 0.253, Train_accy 96.85
2024-01-28 01:29:43,982 [mos.py] => Task 8, Epoch 30/30 => Loss 0.038, CA_accy 100.00
2024-01-28 01:30:04,646 [mos.py] => the accuracy of the original model:56.2
2024-01-28 01:30:04,647 [trainer.py] => No NME accuracy.
2024-01-28 01:30:04,647 [trainer.py] => CNN: {'total': 56.85, '00-19': 55.43, '20-39': 58.38, '40-59': 61.21, '60-79': 62.16, '80-99': 52.45, '100-119': 63.43, '120-139': 57.53, '140-159': 46.46, '160-179': 51.7, 'old': 57.45, 'new': 51.7}
2024-01-28 01:30:04,647 [trainer.py] => CNN top1 curve: [80.57, 77.78, 73.74, 70.77, 67.42, 65.13, 62.44, 59.86, 56.85]
2024-01-28 01:30:04,647 [trainer.py] => CNN top5 curve: [95.43, 94.17, 92.23, 90.97, 88.47, 87.69, 85.91, 83.57, 82.72]

2024-01-28 01:30:04,647 [trainer.py] => Average Accuracy (CNN): 68.28444444444443 

2024-01-28 01:30:04,649 [trainer.py] => All params: 89133897
2024-01-28 01:30:04,651 [trainer.py] => Trainable params: 3197000
2024-01-28 01:30:04,652 [mos.py] => Learning on 180-200
2024-01-28 01:30:27,351 [mos.py] => Task 9, Epoch 10/10 => Loss 0.209, Train_accy 96.58
2024-01-28 01:30:51,594 [mos.py] => Task 9, Epoch 30/30 => Loss 0.042, CA_accy 100.00
2024-01-28 01:31:15,853 [mos.py] => the accuracy of the original model:55.37
2024-01-28 01:31:15,855 [trainer.py] => No NME accuracy.
2024-01-28 01:31:15,855 [trainer.py] => CNN: {'total': 56.22, '00-19': 55.43, '20-39': 57.84, '40-59': 61.21, '60-79': 62.61, '80-99': 52.45, '100-119': 61.19, '120-139': 56.85, '140-159': 45.67, '160-179': 50.34, '180-199': 54.84, 'old': 56.34, 'new': 54.84}
2024-01-28 01:31:15,855 [trainer.py] => CNN top1 curve: [80.57, 77.78, 73.74, 70.77, 67.42, 65.13, 62.44, 59.86, 56.85, 56.22]
2024-01-28 01:31:15,855 [trainer.py] => CNN top5 curve: [95.43, 94.17, 92.23, 90.97, 88.47, 87.69, 85.91, 83.57, 82.72, 81.63]

2024-01-28 01:31:15,855 [trainer.py] => Average Accuracy (CNN): 67.078 

2024-01-28 01:31:15,856 [trainer.py] => Forgetting (CNN): 9.824444444444442
