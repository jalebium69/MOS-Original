2024-01-27 21:31:36,161 [trainer.py] => config: ./exps/mos_ina.json
2024-01-27 21:31:36,161 [trainer.py] => prefix:  
2024-01-27 21:31:36,161 [trainer.py] => dataset: imageneta
2024-01-27 21:31:36,161 [trainer.py] => memory_size: 0
2024-01-27 21:31:36,161 [trainer.py] => memory_per_class: 0
2024-01-27 21:31:36,161 [trainer.py] => fixed_memory: False
2024-01-27 21:31:36,161 [trainer.py] => shuffle: True
2024-01-27 21:31:36,161 [trainer.py] => init_cls: 20
2024-01-27 21:31:36,161 [trainer.py] => increment: 20
2024-01-27 21:31:36,161 [trainer.py] => model_name: mos
2024-01-27 21:31:36,161 [trainer.py] => backbone_type: vit_base_patch16_224_mos
2024-01-27 21:31:36,161 [trainer.py] => device: [device(type='cuda', index=3)]
2024-01-27 21:31:36,161 [trainer.py] => seed: 1993
2024-01-27 21:31:36,161 [trainer.py] => tuned_epoch: 10
2024-01-27 21:31:36,161 [trainer.py] => init_lr: 0.05
2024-01-27 21:31:36,161 [trainer.py] => batch_size: 32
2024-01-27 21:31:36,161 [trainer.py] => weight_decay: 0.005
2024-01-27 21:31:36,161 [trainer.py] => min_lr: 0
2024-01-27 21:31:36,161 [trainer.py] => optimizer: sgd
2024-01-27 21:31:36,161 [trainer.py] => scheduler: cosine
2024-01-27 21:31:36,161 [trainer.py] => reinit_optimizer: True
2024-01-27 21:31:36,161 [trainer.py] => init_milestones: [10]
2024-01-27 21:31:36,161 [trainer.py] => init_lr_decay: 0.1
2024-01-27 21:31:36,161 [trainer.py] => reg: 0.1
2024-01-27 21:31:36,161 [trainer.py] => adapter_momentum: 0.1
2024-01-27 21:31:36,161 [trainer.py] => ensemble: True
2024-01-27 21:31:36,161 [trainer.py] => crct_epochs: 30
2024-01-27 21:31:36,161 [trainer.py] => ca_lr: 0.005
2024-01-27 21:31:36,161 [trainer.py] => ca_storage_efficient_method: variance
2024-01-27 21:31:36,161 [trainer.py] => ca_storage_efficient_method_choices: ['covariance', 'multi-centroid', 'variance']
2024-01-27 21:31:36,162 [trainer.py] => n_centroids: 10
2024-01-27 21:31:36,162 [trainer.py] => pretrained: True
2024-01-27 21:31:36,162 [trainer.py] => drop: 0.0
2024-01-27 21:31:36,162 [trainer.py] => drop_path: 0.0
2024-01-27 21:31:36,162 [trainer.py] => ffn_num: 16
2024-01-27 21:31:36,217 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-01-27 21:31:39,739 [mos.py] => 86,256,776 model total parameters.
2024-01-27 21:31:39,740 [mos.py] => 458,120 model training parameters.
2024-01-27 21:31:39,741 [mos.py] => head.weight: 153600
2024-01-27 21:31:39,741 [mos.py] => head.bias: 200
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.0.down_proj.weight: 12288
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.0.down_proj.bias: 16
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.0.up_proj.weight: 12288
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.0.up_proj.bias: 768
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.1.down_proj.weight: 12288
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.1.down_proj.bias: 16
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.1.up_proj.weight: 12288
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.1.up_proj.bias: 768
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.2.down_proj.weight: 12288
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.2.down_proj.bias: 16
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.2.up_proj.weight: 12288
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.2.up_proj.bias: 768
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.3.down_proj.weight: 12288
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.3.down_proj.bias: 16
2024-01-27 21:31:39,741 [mos.py] => cur_adapter.3.up_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.3.up_proj.bias: 768
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.4.down_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.4.down_proj.bias: 16
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.4.up_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.4.up_proj.bias: 768
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.5.down_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.5.down_proj.bias: 16
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.5.up_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.5.up_proj.bias: 768
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.6.down_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.6.down_proj.bias: 16
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.6.up_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.6.up_proj.bias: 768
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.7.down_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.7.down_proj.bias: 16
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.7.up_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.7.up_proj.bias: 768
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.8.down_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.8.down_proj.bias: 16
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.8.up_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.8.up_proj.bias: 768
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.9.down_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.9.down_proj.bias: 16
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.9.up_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.9.up_proj.bias: 768
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.10.down_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.10.down_proj.bias: 16
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.10.up_proj.weight: 12288
2024-01-27 21:31:39,742 [mos.py] => cur_adapter.10.up_proj.bias: 768
2024-01-27 21:31:39,743 [mos.py] => cur_adapter.11.down_proj.weight: 12288
2024-01-27 21:31:39,743 [mos.py] => cur_adapter.11.down_proj.bias: 16
2024-01-27 21:31:39,743 [mos.py] => cur_adapter.11.up_proj.weight: 12288
2024-01-27 21:31:39,743 [mos.py] => cur_adapter.11.up_proj.bias: 768
2024-01-27 21:31:39,743 [trainer.py] => All params: 86256776
2024-01-27 21:31:39,744 [trainer.py] => Trainable params: 458120
2024-01-27 21:31:39,744 [mos.py] => Learning on 0-20
2024-01-27 21:32:09,957 [mos.py] => Task 0, Epoch 10/10 => Loss 0.292, Train_accy 93.05
2024-01-27 21:32:28,526 [mos.py] => the accuracy of the original model:80.57
2024-01-27 21:32:28,528 [trainer.py] => No NME accuracy.
2024-01-27 21:32:28,528 [trainer.py] => CNN: {'total': 80.57, '00-19': 80.57, 'old': 0, 'new': 80.57}
2024-01-27 21:32:28,528 [trainer.py] => CNN top1 curve: [80.57]
2024-01-27 21:32:28,528 [trainer.py] => CNN top5 curve: [96.57]

2024-01-27 21:32:28,529 [trainer.py] => Average Accuracy (CNN): 80.57 

2024-01-27 21:32:28,530 [trainer.py] => All params: 86576457
2024-01-27 21:32:28,531 [trainer.py] => Trainable params: 762440
2024-01-27 21:32:28,533 [mos.py] => Learning on 20-40
2024-01-27 21:33:03,335 [mos.py] => Task 1, Epoch 10/10 => Loss 0.280, Train_accy 93.99
2024-01-27 21:33:24,082 [mos.py] => Task 1, Epoch 30/30 => Loss 0.007, CA_accy 99.89
2024-01-27 21:33:28,189 [mos.py] => the accuracy of the original model:79.44
2024-01-27 21:33:28,191 [trainer.py] => No NME accuracy.
2024-01-27 21:33:28,191 [trainer.py] => CNN: {'total': 79.17, '00-19': 76.57, '20-39': 81.62, 'old': 76.57, 'new': 81.62}
2024-01-27 21:33:28,191 [trainer.py] => CNN top1 curve: [80.57, 79.17]
2024-01-27 21:33:28,191 [trainer.py] => CNN top5 curve: [96.57, 94.44]

2024-01-27 21:33:28,191 [trainer.py] => Average Accuracy (CNN): 79.87 

2024-01-27 21:33:28,193 [trainer.py] => All params: 86896137
2024-01-27 21:33:28,194 [trainer.py] => Trainable params: 1066760
2024-01-27 21:33:28,196 [mos.py] => Learning on 40-60
2024-01-27 21:33:54,078 [mos.py] => Task 2, Epoch 10/10 => Loss 0.303, Train_accy 95.69
2024-01-27 21:34:13,959 [mos.py] => Task 2, Epoch 30/30 => Loss 0.006, CA_accy 99.96
2024-01-27 21:34:19,031 [mos.py] => the accuracy of the original model:75.63
2024-01-27 21:34:19,032 [trainer.py] => No NME accuracy.
2024-01-27 21:34:19,032 [trainer.py] => CNN: {'total': 75.42, '00-19': 74.29, '20-39': 76.76, '40-59': 75.0, 'old': 75.56, 'new': 75.0}
2024-01-27 21:34:19,032 [trainer.py] => CNN top1 curve: [80.57, 79.17, 75.42]
2024-01-27 21:34:19,032 [trainer.py] => CNN top5 curve: [96.57, 94.44, 93.91]

2024-01-27 21:34:19,032 [trainer.py] => Average Accuracy (CNN): 78.38666666666667 

2024-01-27 21:34:19,034 [trainer.py] => All params: 87215817
2024-01-27 21:34:19,035 [trainer.py] => Trainable params: 1371080
2024-01-27 21:34:19,036 [mos.py] => Learning on 60-80
2024-01-27 21:34:54,579 [mos.py] => Task 3, Epoch 10/10 => Loss 0.422, Train_accy 95.03
2024-01-27 21:35:19,564 [mos.py] => Task 3, Epoch 30/30 => Loss 0.008, CA_accy 99.98
2024-01-27 21:35:27,537 [mos.py] => the accuracy of the original model:71.49
2024-01-27 21:35:27,537 [trainer.py] => No NME accuracy.
2024-01-27 21:35:27,537 [trainer.py] => CNN: {'total': 72.78, '00-19': 69.71, '20-39': 74.05, '40-59': 70.69, '60-79': 75.23, 'old': 71.64, 'new': 75.23}
2024-01-27 21:35:27,537 [trainer.py] => CNN top1 curve: [80.57, 79.17, 75.42, 72.78]
2024-01-27 21:35:27,537 [trainer.py] => CNN top5 curve: [96.57, 94.44, 93.91, 93.12]

2024-01-27 21:35:27,538 [trainer.py] => Average Accuracy (CNN): 76.98500000000001 

2024-01-27 21:35:27,539 [trainer.py] => All params: 87535497
2024-01-27 21:35:27,540 [trainer.py] => Trainable params: 1675400
2024-01-27 21:35:27,541 [mos.py] => Learning on 80-100
2024-01-27 21:35:53,875 [mos.py] => Task 4, Epoch 10/10 => Loss 0.381, Train_accy 95.23
2024-01-27 21:36:18,079 [mos.py] => Task 4, Epoch 30/30 => Loss 0.010, CA_accy 100.00
2024-01-27 21:36:27,592 [mos.py] => the accuracy of the original model:67.54
2024-01-27 21:36:27,594 [trainer.py] => No NME accuracy.
2024-01-27 21:36:27,594 [trainer.py] => CNN: {'total': 68.73, '00-19': 67.43, '20-39': 72.43, '40-59': 68.1, '60-79': 71.17, '80-99': 62.24, 'old': 70.06, 'new': 62.24}
2024-01-27 21:36:27,594 [trainer.py] => CNN top1 curve: [80.57, 79.17, 75.42, 72.78, 68.73]
2024-01-27 21:36:27,594 [trainer.py] => CNN top5 curve: [96.57, 94.44, 93.91, 93.12, 90.01]

2024-01-27 21:36:27,594 [trainer.py] => Average Accuracy (CNN): 75.33400000000002 

2024-01-27 21:36:27,596 [trainer.py] => All params: 87855177
2024-01-27 21:36:27,597 [trainer.py] => Trainable params: 1979720
2024-01-27 21:36:27,598 [mos.py] => Learning on 100-120
2024-01-27 21:36:52,772 [mos.py] => Task 5, Epoch 10/10 => Loss 0.440, Train_accy 93.69
2024-01-27 21:37:18,512 [mos.py] => Task 5, Epoch 30/30 => Loss 0.012, CA_accy 100.00
2024-01-27 21:37:30,048 [mos.py] => the accuracy of the original model:66.36
2024-01-27 21:37:30,050 [trainer.py] => No NME accuracy.
2024-01-27 21:37:30,050 [trainer.py] => CNN: {'total': 67.9, '00-19': 63.43, '20-39': 72.97, '40-59': 68.1, '60-79': 70.27, '80-99': 59.44, '100-119': 71.64, 'old': 67.3, 'new': 71.64}
2024-01-27 21:37:30,050 [trainer.py] => CNN top1 curve: [80.57, 79.17, 75.42, 72.78, 68.73, 67.9]
2024-01-27 21:37:30,050 [trainer.py] => CNN top5 curve: [96.57, 94.44, 93.91, 93.12, 90.01, 88.31]

2024-01-27 21:37:30,051 [trainer.py] => Average Accuracy (CNN): 74.09500000000001 

2024-01-27 21:37:30,052 [trainer.py] => All params: 88174857
2024-01-27 21:37:30,053 [trainer.py] => Trainable params: 2284040
2024-01-27 21:37:30,055 [mos.py] => Learning on 120-140
2024-01-27 21:37:55,179 [mos.py] => Task 6, Epoch 10/10 => Loss 0.337, Train_accy 94.81
2024-01-27 21:38:19,601 [mos.py] => Task 6, Epoch 30/30 => Loss 0.015, CA_accy 100.00
2024-01-27 21:38:34,083 [mos.py] => the accuracy of the original model:63.51
2024-01-27 21:38:34,085 [trainer.py] => No NME accuracy.
2024-01-27 21:38:34,085 [trainer.py] => CNN: {'total': 65.83, '00-19': 60.0, '20-39': 70.81, '40-59': 66.38, '60-79': 68.02, '80-99': 59.44, '100-119': 69.4, '120-139': 65.75, 'old': 65.85, 'new': 65.75}
2024-01-27 21:38:34,086 [trainer.py] => CNN top1 curve: [80.57, 79.17, 75.42, 72.78, 68.73, 67.9, 65.83]
2024-01-27 21:38:34,086 [trainer.py] => CNN top5 curve: [96.57, 94.44, 93.91, 93.12, 90.01, 88.31, 87.07]

2024-01-27 21:38:34,086 [trainer.py] => Average Accuracy (CNN): 72.91428571428573 

2024-01-27 21:38:34,089 [trainer.py] => All params: 88494537
2024-01-27 21:38:34,092 [trainer.py] => Trainable params: 2588360
2024-01-27 21:38:34,095 [mos.py] => Learning on 140-160
2024-01-27 21:39:00,136 [mos.py] => Task 7, Epoch 10/10 => Loss 0.300, Train_accy 96.23
2024-01-27 21:39:25,954 [mos.py] => Task 7, Epoch 30/30 => Loss 0.018, CA_accy 100.00
2024-01-27 21:39:42,971 [mos.py] => the accuracy of the original model:61.46
2024-01-27 21:39:42,974 [trainer.py] => No NME accuracy.
2024-01-27 21:39:42,974 [trainer.py] => CNN: {'total': 63.06, '00-19': 54.29, '20-39': 67.57, '40-59': 66.38, '60-79': 66.22, '80-99': 58.74, '100-119': 66.42, '120-139': 64.38, '140-159': 59.84, 'old': 63.43, 'new': 59.84}
2024-01-27 21:39:42,974 [trainer.py] => CNN top1 curve: [80.57, 79.17, 75.42, 72.78, 68.73, 67.9, 65.83, 63.06]
2024-01-27 21:39:42,974 [trainer.py] => CNN top5 curve: [96.57, 94.44, 93.91, 93.12, 90.01, 88.31, 87.07, 85.9]

2024-01-27 21:39:42,974 [trainer.py] => Average Accuracy (CNN): 71.6825 

2024-01-27 21:39:42,979 [trainer.py] => All params: 88814217
2024-01-27 21:39:42,983 [trainer.py] => Trainable params: 2892680
2024-01-27 21:39:42,984 [mos.py] => Learning on 160-180
2024-01-27 21:40:10,819 [mos.py] => Task 8, Epoch 10/10 => Loss 0.420, Train_accy 94.92
2024-01-27 21:40:41,104 [mos.py] => Task 8, Epoch 30/30 => Loss 0.021, CA_accy 100.00
2024-01-27 21:41:01,621 [mos.py] => the accuracy of the original model:59.0
2024-01-27 21:41:01,622 [trainer.py] => No NME accuracy.
2024-01-27 21:41:01,622 [trainer.py] => CNN: {'total': 60.43, '00-19': 53.71, '20-39': 65.95, '40-59': 65.52, '60-79': 65.32, '80-99': 56.64, '100-119': 64.18, '120-139': 59.59, '140-159': 56.69, '160-179': 54.42, 'old': 61.14, 'new': 54.42}
2024-01-27 21:41:01,622 [trainer.py] => CNN top1 curve: [80.57, 79.17, 75.42, 72.78, 68.73, 67.9, 65.83, 63.06, 60.43]
2024-01-27 21:41:01,622 [trainer.py] => CNN top5 curve: [96.57, 94.44, 93.91, 93.12, 90.01, 88.31, 87.07, 85.9, 84.09]

2024-01-27 21:41:01,622 [trainer.py] => Average Accuracy (CNN): 70.43222222222222 

2024-01-27 21:41:01,624 [trainer.py] => All params: 89133897
2024-01-27 21:41:01,625 [trainer.py] => Trainable params: 3197000
2024-01-27 21:41:01,627 [mos.py] => Learning on 180-200
2024-01-27 21:41:28,218 [mos.py] => Task 9, Epoch 10/10 => Loss 0.397, Train_accy 96.39
2024-01-27 21:41:56,049 [mos.py] => Task 9, Epoch 30/30 => Loss 0.023, CA_accy 100.00
2024-01-27 21:42:20,425 [mos.py] => the accuracy of the original model:58.26
2024-01-27 21:42:20,427 [trainer.py] => No NME accuracy.
2024-01-27 21:42:20,427 [trainer.py] => CNN: {'total': 60.04, '00-19': 52.0, '20-39': 65.41, '40-59': 64.66, '60-79': 65.32, '80-99': 55.94, '100-119': 62.69, '120-139': 56.85, '140-159': 56.69, '160-179': 54.42, '180-199': 65.32, 'old': 59.57, 'new': 65.32}
2024-01-27 21:42:20,427 [trainer.py] => CNN top1 curve: [80.57, 79.17, 75.42, 72.78, 68.73, 67.9, 65.83, 63.06, 60.43, 60.04]
2024-01-27 21:42:20,428 [trainer.py] => CNN top5 curve: [96.57, 94.44, 93.91, 93.12, 90.01, 88.31, 87.07, 85.9, 84.09, 83.21]

2024-01-27 21:42:20,428 [trainer.py] => Average Accuracy (CNN): 69.393 

2024-01-27 21:42:20,429 [trainer.py] => Forgetting (CNN): 10.258888888888892
