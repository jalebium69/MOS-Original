2024-01-28 03:14:55,781 [trainer.py] => config: ./exps/mos_obj_in21k.json
2024-01-28 03:14:55,781 [trainer.py] => prefix:  
2024-01-28 03:14:55,781 [trainer.py] => dataset: objectnet
2024-01-28 03:14:55,781 [trainer.py] => memory_size: 0
2024-01-28 03:14:55,781 [trainer.py] => memory_per_class: 0
2024-01-28 03:14:55,781 [trainer.py] => fixed_memory: False
2024-01-28 03:14:55,781 [trainer.py] => shuffle: True
2024-01-28 03:14:55,781 [trainer.py] => init_cls: 20
2024-01-28 03:14:55,782 [trainer.py] => increment: 20
2024-01-28 03:14:55,782 [trainer.py] => model_name: mos
2024-01-28 03:14:55,782 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_mos
2024-01-28 03:14:55,782 [trainer.py] => device: [device(type='cuda', index=2)]
2024-01-28 03:14:55,782 [trainer.py] => seed: 1993
2024-01-28 03:14:55,782 [trainer.py] => tuned_epoch: 10
2024-01-28 03:14:55,782 [trainer.py] => init_lr: 0.05
2024-01-28 03:14:55,782 [trainer.py] => batch_size: 48
2024-01-28 03:14:55,782 [trainer.py] => weight_decay: 0.005
2024-01-28 03:14:55,782 [trainer.py] => min_lr: 0
2024-01-28 03:14:55,782 [trainer.py] => optimizer: sgd
2024-01-28 03:14:55,782 [trainer.py] => scheduler: cosine
2024-01-28 03:14:55,782 [trainer.py] => reinit_optimizer: True
2024-01-28 03:14:55,782 [trainer.py] => init_milestones: [10]
2024-01-28 03:14:55,782 [trainer.py] => init_lr_decay: 0.1
2024-01-28 03:14:55,782 [trainer.py] => reg: 0.1
2024-01-28 03:14:55,782 [trainer.py] => adapter_momentum: 0.1
2024-01-28 03:14:55,782 [trainer.py] => ensemble: True
2024-01-28 03:14:55,782 [trainer.py] => crct_epochs: 30
2024-01-28 03:14:55,782 [trainer.py] => ca_lr: 0.005
2024-01-28 03:14:55,782 [trainer.py] => ca_storage_efficient_method: covariance
2024-01-28 03:14:55,782 [trainer.py] => ca_storage_efficient_method_choices: ['covariance', 'multi-centroid', 'variance']
2024-01-28 03:14:55,782 [trainer.py] => n_centroids: 10
2024-01-28 03:14:55,782 [trainer.py] => pretrained: True
2024-01-28 03:14:55,782 [trainer.py] => drop: 0.0
2024-01-28 03:14:55,782 [trainer.py] => drop_path: 0.0
2024-01-28 03:14:55,782 [trainer.py] => ffn_num: 16
2024-01-28 03:14:55,885 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-01-28 03:14:59,350 [mos.py] => 86,256,776 model total parameters.
2024-01-28 03:14:59,350 [mos.py] => 458,120 model training parameters.
2024-01-28 03:14:59,351 [mos.py] => head.weight: 153600
2024-01-28 03:14:59,351 [mos.py] => head.bias: 200
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.0.down_proj.weight: 12288
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.0.down_proj.bias: 16
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.0.up_proj.weight: 12288
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.0.up_proj.bias: 768
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.1.down_proj.weight: 12288
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.1.down_proj.bias: 16
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.1.up_proj.weight: 12288
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.1.up_proj.bias: 768
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.2.down_proj.weight: 12288
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.2.down_proj.bias: 16
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.2.up_proj.weight: 12288
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.2.up_proj.bias: 768
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.3.down_proj.weight: 12288
2024-01-28 03:14:59,351 [mos.py] => cur_adapter.3.down_proj.bias: 16
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.3.up_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.3.up_proj.bias: 768
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.4.down_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.4.down_proj.bias: 16
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.4.up_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.4.up_proj.bias: 768
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.5.down_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.5.down_proj.bias: 16
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.5.up_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.5.up_proj.bias: 768
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.6.down_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.6.down_proj.bias: 16
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.6.up_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.6.up_proj.bias: 768
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.7.down_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.7.down_proj.bias: 16
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.7.up_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.7.up_proj.bias: 768
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.8.down_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.8.down_proj.bias: 16
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.8.up_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.8.up_proj.bias: 768
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.9.down_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.9.down_proj.bias: 16
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.9.up_proj.weight: 12288
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.9.up_proj.bias: 768
2024-01-28 03:14:59,352 [mos.py] => cur_adapter.10.down_proj.weight: 12288
2024-01-28 03:14:59,353 [mos.py] => cur_adapter.10.down_proj.bias: 16
2024-01-28 03:14:59,353 [mos.py] => cur_adapter.10.up_proj.weight: 12288
2024-01-28 03:14:59,353 [mos.py] => cur_adapter.10.up_proj.bias: 768
2024-01-28 03:14:59,353 [mos.py] => cur_adapter.11.down_proj.weight: 12288
2024-01-28 03:14:59,353 [mos.py] => cur_adapter.11.down_proj.bias: 16
2024-01-28 03:14:59,353 [mos.py] => cur_adapter.11.up_proj.weight: 12288
2024-01-28 03:14:59,353 [mos.py] => cur_adapter.11.up_proj.bias: 768
2024-01-28 03:14:59,353 [trainer.py] => All params: 86256776
2024-01-28 03:14:59,354 [trainer.py] => Trainable params: 458120
2024-01-28 03:14:59,354 [mos.py] => Learning on 0-20
2024-01-28 03:22:18,622 [mos.py] => Task 0, Epoch 10/10 => Loss 0.648, Train_accy 81.19
2024-01-28 03:28:53,495 [mos.py] => the accuracy of the original model:85.77
2024-01-28 03:28:53,497 [trainer.py] => No NME accuracy.
2024-01-28 03:28:53,497 [trainer.py] => CNN: {'total': 88.31, '00-19': 88.31, 'old': 0, 'new': 88.31}
2024-01-28 03:28:53,497 [trainer.py] => CNN top1 curve: [88.31]
2024-01-28 03:28:53,497 [trainer.py] => CNN top5 curve: [97.89]

2024-01-28 03:28:53,497 [trainer.py] => Average Accuracy (CNN): 88.31 

2024-01-28 03:28:53,499 [trainer.py] => All params: 86576457
2024-01-28 03:28:53,499 [trainer.py] => Trainable params: 762440
2024-01-28 03:28:53,501 [mos.py] => Learning on 20-40
2024-01-28 03:35:31,659 [mos.py] => Task 1, Epoch 10/10 => Loss 0.829, Train_accy 80.57
2024-01-28 03:40:49,319 [mos.py] => Task 1, Epoch 30/30 => Loss 0.049, CA_accy 99.38
2024-01-28 03:41:59,571 [mos.py] => the accuracy of the original model:82.28
2024-01-28 03:41:59,574 [trainer.py] => No NME accuracy.
2024-01-28 03:41:59,574 [trainer.py] => CNN: {'total': 86.14, '00-19': 85.77, '20-39': 86.54, 'old': 85.77, 'new': 86.54}
2024-01-28 03:41:59,574 [trainer.py] => CNN top1 curve: [88.31, 86.14]
2024-01-28 03:41:59,574 [trainer.py] => CNN top5 curve: [97.89, 96.22]

2024-01-28 03:41:59,574 [trainer.py] => Average Accuracy (CNN): 87.225 

2024-01-28 03:41:59,575 [trainer.py] => All params: 86896137
2024-01-28 03:41:59,576 [trainer.py] => Trainable params: 1066760
2024-01-28 03:41:59,577 [mos.py] => Learning on 40-60
2024-01-28 03:48:46,029 [mos.py] => Task 2, Epoch 10/10 => Loss 1.212, Train_accy 80.23
2024-01-28 03:54:35,960 [mos.py] => Task 2, Epoch 30/30 => Loss 0.071, CA_accy 99.10
2024-01-28 03:55:57,805 [mos.py] => the accuracy of the original model:78.61
2024-01-28 03:55:57,807 [trainer.py] => No NME accuracy.
2024-01-28 03:55:57,807 [trainer.py] => CNN: {'total': 81.13, '00-19': 81.97, '20-39': 81.85, '40-59': 79.46, 'old': 81.91, 'new': 79.46}
2024-01-28 03:55:57,808 [trainer.py] => CNN top1 curve: [88.31, 86.14, 81.13]
2024-01-28 03:55:57,808 [trainer.py] => CNN top5 curve: [97.89, 96.22, 94.9]

2024-01-28 03:55:57,808 [trainer.py] => Average Accuracy (CNN): 85.19333333333333 

2024-01-28 03:55:57,810 [trainer.py] => All params: 87215817
2024-01-28 03:55:57,811 [trainer.py] => Trainable params: 1371080
2024-01-28 03:55:57,814 [mos.py] => Learning on 60-80
2024-01-28 04:02:44,658 [mos.py] => Task 3, Epoch 10/10 => Loss 1.203, Train_accy 78.17
2024-01-28 04:08:24,035 [mos.py] => Task 3, Epoch 30/30 => Loss 0.101, CA_accy 98.74
2024-01-28 04:09:55,483 [mos.py] => the accuracy of the original model:72.81
2024-01-28 04:09:55,485 [trainer.py] => No NME accuracy.
2024-01-28 04:09:55,485 [trainer.py] => CNN: {'total': 77.21, '00-19': 77.61, '20-39': 79.19, '40-59': 78.2, '60-79': 74.1, 'old': 78.3, 'new': 74.1}
2024-01-28 04:09:55,485 [trainer.py] => CNN top1 curve: [88.31, 86.14, 81.13, 77.21]
2024-01-28 04:09:55,485 [trainer.py] => CNN top5 curve: [97.89, 96.22, 94.9, 93.84]

2024-01-28 04:09:55,485 [trainer.py] => Average Accuracy (CNN): 83.19749999999999 

2024-01-28 04:09:55,486 [trainer.py] => All params: 87535497
2024-01-28 04:09:55,487 [trainer.py] => Trainable params: 1675400
2024-01-28 04:09:55,489 [mos.py] => Learning on 80-100
2024-01-28 04:16:50,556 [mos.py] => Task 4, Epoch 10/10 => Loss 1.232, Train_accy 80.77
2024-01-28 04:22:29,818 [mos.py] => Task 4, Epoch 30/30 => Loss 0.119, CA_accy 98.54
2024-01-28 04:24:14,395 [mos.py] => the accuracy of the original model:70.98
2024-01-28 04:24:14,398 [trainer.py] => No NME accuracy.
2024-01-28 04:24:14,399 [trainer.py] => CNN: {'total': 75.41, '00-19': 76.76, '20-39': 77.46, '40-59': 75.83, '60-79': 71.8, '80-99': 75.38, 'old': 75.42, 'new': 75.38}
2024-01-28 04:24:14,399 [trainer.py] => CNN top1 curve: [88.31, 86.14, 81.13, 77.21, 75.41]
2024-01-28 04:24:14,399 [trainer.py] => CNN top5 curve: [97.89, 96.22, 94.9, 93.84, 92.78]

2024-01-28 04:24:14,399 [trainer.py] => Average Accuracy (CNN): 81.63999999999999 

2024-01-28 04:24:14,402 [trainer.py] => All params: 87855177
2024-01-28 04:24:14,403 [trainer.py] => Trainable params: 1979720
2024-01-28 04:24:14,405 [mos.py] => Learning on 100-120
2024-01-28 04:31:12,665 [mos.py] => Task 5, Epoch 10/10 => Loss 1.283, Train_accy 79.87
2024-01-28 04:36:50,981 [mos.py] => Task 5, Epoch 30/30 => Loss 0.147, CA_accy 98.13
2024-01-28 04:38:48,410 [mos.py] => the accuracy of the original model:67.86
2024-01-28 04:38:48,414 [trainer.py] => No NME accuracy.
2024-01-28 04:38:48,414 [trainer.py] => CNN: {'total': 73.25, '00-19': 75.07, '20-39': 75.27, '40-59': 73.62, '60-79': 70.22, '80-99': 75.04, '100-119': 70.65, 'old': 73.79, 'new': 70.65}
2024-01-28 04:38:48,414 [trainer.py] => CNN top1 curve: [88.31, 86.14, 81.13, 77.21, 75.41, 73.25]
2024-01-28 04:38:48,414 [trainer.py] => CNN top5 curve: [97.89, 96.22, 94.9, 93.84, 92.78, 90.93]

2024-01-28 04:38:48,414 [trainer.py] => Average Accuracy (CNN): 80.24166666666666 

2024-01-28 04:38:48,416 [trainer.py] => All params: 88174857
2024-01-28 04:38:48,417 [trainer.py] => Trainable params: 2284040
2024-01-28 04:38:48,419 [mos.py] => Learning on 120-140
2024-01-28 04:45:45,180 [mos.py] => Task 6, Epoch 10/10 => Loss 1.197, Train_accy 79.57
2024-01-28 04:51:20,042 [mos.py] => Task 6, Epoch 30/30 => Loss 0.175, CA_accy 97.84
2024-01-28 04:53:24,274 [mos.py] => the accuracy of the original model:65.75
2024-01-28 04:53:24,277 [trainer.py] => No NME accuracy.
2024-01-28 04:53:24,277 [trainer.py] => CNN: {'total': 70.58, '00-19': 72.54, '20-39': 72.61, '40-59': 73.3, '60-79': 67.48, '80-99': 72.68, '100-119': 66.67, '120-139': 69.32, 'old': 70.8, 'new': 69.32}
2024-01-28 04:53:24,277 [trainer.py] => CNN top1 curve: [88.31, 86.14, 81.13, 77.21, 75.41, 73.25, 70.58]
2024-01-28 04:53:24,277 [trainer.py] => CNN top5 curve: [97.89, 96.22, 94.9, 93.84, 92.78, 90.93, 90.09]

2024-01-28 04:53:24,277 [trainer.py] => Average Accuracy (CNN): 78.86142857142856 

2024-01-28 04:53:24,279 [trainer.py] => All params: 88494537
2024-01-28 04:53:24,281 [trainer.py] => Trainable params: 2588360
2024-01-28 04:53:24,284 [mos.py] => Learning on 140-160
2024-01-28 05:00:51,907 [mos.py] => Task 7, Epoch 10/10 => Loss 1.326, Train_accy 78.87
2024-01-28 05:06:42,559 [mos.py] => Task 7, Epoch 30/30 => Loss 0.212, CA_accy 97.06
2024-01-28 05:09:03,966 [mos.py] => the accuracy of the original model:63.72
2024-01-28 05:09:03,968 [trainer.py] => No NME accuracy.
2024-01-28 05:09:03,968 [trainer.py] => CNN: {'total': 68.4, '00-19': 70.42, '20-39': 71.83, '40-59': 69.51, '60-79': 66.76, '80-99': 71.5, '100-119': 65.49, '120-139': 67.37, '140-159': 65.17, 'old': 68.91, 'new': 65.17}
2024-01-28 05:09:03,968 [trainer.py] => CNN top1 curve: [88.31, 86.14, 81.13, 77.21, 75.41, 73.25, 70.58, 68.4]
2024-01-28 05:09:03,968 [trainer.py] => CNN top5 curve: [97.89, 96.22, 94.9, 93.84, 92.78, 90.93, 90.09, 88.37]

2024-01-28 05:09:03,968 [trainer.py] => Average Accuracy (CNN): 77.55375 

2024-01-28 05:09:03,970 [trainer.py] => All params: 88814217
2024-01-28 05:09:03,971 [trainer.py] => Trainable params: 2892680
2024-01-28 05:09:03,973 [mos.py] => Learning on 160-180
2024-01-28 05:15:43,082 [mos.py] => Task 8, Epoch 10/10 => Loss 1.364, Train_accy 76.86
2024-01-28 05:20:52,811 [mos.py] => Task 8, Epoch 30/30 => Loss 0.246, CA_accy 96.43
2024-01-28 05:23:20,967 [mos.py] => the accuracy of the original model:62.07
2024-01-28 05:23:20,970 [trainer.py] => No NME accuracy.
2024-01-28 05:23:20,970 [trainer.py] => CNN: {'total': 66.71, '00-19': 69.15, '20-39': 71.05, '40-59': 67.77, '60-79': 65.61, '80-99': 69.98, '100-119': 64.6, '120-139': 67.07, '140-159': 63.27, '160-179': 62.48, 'old': 67.2, 'new': 62.48}
2024-01-28 05:23:20,970 [trainer.py] => CNN top1 curve: [88.31, 86.14, 81.13, 77.21, 75.41, 73.25, 70.58, 68.4, 66.71]
2024-01-28 05:23:20,970 [trainer.py] => CNN top5 curve: [97.89, 96.22, 94.9, 93.84, 92.78, 90.93, 90.09, 88.37, 87.33]

2024-01-28 05:23:20,970 [trainer.py] => Average Accuracy (CNN): 76.3488888888889 

2024-01-28 05:23:20,972 [trainer.py] => All params: 89133897
2024-01-28 05:23:20,974 [trainer.py] => Trainable params: 3197000
2024-01-28 05:23:20,977 [mos.py] => Learning on 180-200
2024-01-28 05:30:19,300 [mos.py] => Task 9, Epoch 10/10 => Loss 1.466, Train_accy 78.41
2024-01-28 05:36:00,307 [mos.py] => Task 9, Epoch 30/30 => Loss 0.278, CA_accy 95.70
2024-01-28 05:38:39,765 [mos.py] => the accuracy of the original model:60.2
2024-01-28 05:38:39,768 [trainer.py] => No NME accuracy.
2024-01-28 05:38:39,769 [trainer.py] => CNN: {'total': 64.92, '00-19': 68.59, '20-39': 70.42, '40-59': 68.25, '60-79': 64.6, '80-99': 69.31, '100-119': 62.39, '120-139': 65.56, '140-159': 61.5, '160-179': 58.19, '180-199': 60.98, 'old': 65.35, 'new': 60.98}
2024-01-28 05:38:39,769 [trainer.py] => CNN top1 curve: [88.31, 86.14, 81.13, 77.21, 75.41, 73.25, 70.58, 68.4, 66.71, 64.92]
2024-01-28 05:38:39,769 [trainer.py] => CNN top5 curve: [97.89, 96.22, 94.9, 93.84, 92.78, 90.93, 90.09, 88.37, 87.33, 86.39]

2024-01-28 05:38:39,769 [trainer.py] => Average Accuracy (CNN): 75.20599999999999 

2024-01-28 05:38:39,776 [trainer.py] => Forgetting (CNN): 9.177777777777777
